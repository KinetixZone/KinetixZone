export const githubService = { testConnection: async (t: string) => ({ success: true, login: 'User' }), ensureRepoExists: async (c: any) => ({ success: true }), pushFile: async (c: any, p: string, con: string, m: string) => { const url = 'https://api.github.com/repos/' + c.owner + '/' + c.repo + '/contents/' + p; let sha = null; try { const r = await fetch(url, { headers: { 'Authorization': 'token ' + c.token } }); if (r.ok) { const d = await r.json(); sha = d.sha; } } catch (e) {} const b = { message: m, content: btoa(unescape(encodeURIComponent(con))), branch: c.branch, sha: sha || undefined }; const res = await fetch(url, { method: 'PUT', headers: { 'Authorization': 'token ' + c.token, 'Accept': 'application/vnd.github.v3+json', 'Content-Type': 'application/json' }, body: JSON.stringify(b) }); return res.ok; } };